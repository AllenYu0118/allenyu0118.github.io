---
title: å·¥å…·ç±»å‹
date: 2022-04-01 21:53:40
permalink: /pages/23d841/
categories:
  - TypeScript
tags:
  -
---

## å·¥å…·ç±»å‹ (Utility Types)

`TypeScript` æä¾›äº†ä¸€äº›å·¥å…·ç±»å‹ï¼Œæ–¹ä¾¿è¿›è¡Œç±»å‹ä¸Šçš„è½¬æ¢ã€‚è¿™äº›å·¥å…·ç±»å‹æ˜¯å…¨å±€å¯è§çš„ã€‚

## Partial

æ„é€ ä¸€ä¸ªæ–°ç±»å‹ï¼Œä½¿ç±»å‹ `T`ä¸Šçš„æ‰€æœ‰å±æ€§éƒ½å˜æˆå¯é€‰çš„ã€‚

### ä½¿ç”¨

```typescript
interface Person {
  name: string
  age: number
}

type PersonOptional = Partial<Person>

// ç›¸å½“äº
type PersonOptional = {
  name?: string
  age?: number
}
```

### å®ç°

```typescript
type Partial<T> = {
  [K in keyof T]?: T[K]
}
```

---

## Required

è®¾ç½®ç±»å‹çš„æ‰€æœ‰å±æ€§ä¸ºå¿…é¡»é¡¹ã€‚å’Œ `Partial` æ˜¯ç›¸åçš„ã€‚

### ä½¿ç”¨

```typescript
interface Person {
  name?: string
  age?: number
}

const Jack: Person = { name: 'Jack' }
const Lucy: Required<Person> = { name: 'Lucy' }

// Property 'age' is missing in type '{ name: string; }' but required in type 'Required<Person>'.(2741)
```

### å®ç°

```typescript
type Required<T> = {
  [K in keyof T]-?: T[K]
}
```

æ³¨æ„ `-?` è¡¨ç¤º**éå¯é€‰**ï¼Œè¿™é‡Œå¦‚æœä¸åŠ  `-?` åœ¨é‡åˆ° `T` çš„å±æ€§ä¸ºå¯é€‰æ—¶ï¼Œå°±æ— æ³•å˜æˆå¿…é€‰å±æ€§ï¼Œè¿™ä¸ªå°±æ˜¯æŒ‡åŒæ€æ‹·è´ã€‚

ä¸¾ä¸ªä¾‹å­ ğŸŒ°

```typescript
interface T {
  name: string
  age?: number
}

// å®ç°ä¸€ä¸ªä¸ä½¿ç”¨ `-?` çš„ Required
type Required<T> = {
  [K in keyof T]: T[K]
}

// Foo = { name: string, age?: number | undefined }
type Foo = Required<T>

// æ·»åŠ  `-?`
type Required<T> = {
  [K in keyof T]-?: T[K]
}

// Foo = { name: string, age: number }
type Foo = Required<T>
```

---

## Readonly

è®¾ç½®ç±»å‹çš„æ‰€æœ‰å±æ€§ä¸º `readonly`ã€‚ä¹Ÿå°±æ˜¯ä¸èƒ½å†è¢«èµ‹å€¼ã€‚

### ä½¿ç”¨

```typescript
interface Person {
  name: string
  age: number
}
const Lucy: Readonly<Person> = { name: 'Lucy', age: 18 }
Lucy.name = 'Jack'
// Cannot assign to 'name' because it is a read-only property.
```

### å®ç°

```typescript
type Readonly<T> = {
  readonly [K in keyof T]: T[K]
}
```

## Record\<K, T>

æ„é€ ä¸€ä¸ªå¯¹è±¡ç±»å‹, å®ƒçš„ `Keys` æ˜¯ `K`ï¼Œå®ƒçš„ `value` æ˜¯ `T`ã€‚

### ä½¿ç”¨

```typescript
type Point = {
  lat: number
  lng: number
}
type Line = Record<'start' | 'end', Point>

// ç›¸å½“äº
type Line = {
  start: { lat: number; lng: number }
  end: { lat: number; lng: number }
}
```

### å®ç°

```typescript
type Record<K extends keyof any, T> = {
  [P in K]: T
}
```

## Pick\<T, K>

æ¥å£ç±»å‹å·¥å…·ï¼Œä» `T` ç±»å‹ä¸­ï¼Œé€‰å– `K` é€‰é¡¹çš„å±æ€§ï¼Œå¹¶ç»„æˆæ–°çš„ç±»å‹ã€‚

### ä½¿ç”¨

```typescript
type House = {
  lat: number
  lng: number
  address: string
  color: string
}

type Point = Pick<House, 'lat' | 'lng'>

// ç›¸å½“äº
type Point = {
  lat: number
  lng: number
}
```

### å®ç°

```typescript
type Pick<T, K extends keyof T> = {
  [P in K]: T[P]
}
```

---

## Exclude\<T, U>

è”åˆç±»å‹å·¥å…·ï¼Œæ’é™¤è”åˆç±»å‹ `T` ä¸­ä¸ `U` ç›¸ç­‰çš„ç±»å‹ï¼Œè¿”å›ä¸€ä¸ªè”åˆç±»å‹ã€‚

### ä½¿ç”¨

```typescript
interface Person {
  name: string
  age: number
}

type P = Exclude(keyof Person, 'age')
```

### å®ç°

```typescript
type MyExclude<T, U> = T extends U ? never : T
```

## Omit\<T, K>

ä»ç±»å‹ `T` ä¸­ç§»é™¤ `K` ä¸­æ‰€æœ‰çš„å±æ€§ã€‚

### ä½¿ç”¨

```typescript
type House = {
  lat: number
  lng: number
  address: string
  color: string
}

// ç§»é™¤ House ç±»å‹ä¸­çš„ color å’Œ address
type Point = Pick<House, 'color' | 'address'>

// ç›¸å½“äº
type Point = {
  lat: number
  lng: number
}
```

### å®ç°

```typescript
type MyExclude<T, U> = T extends U ? never : T
type MyOmit<T, K extends keyof T> = {
  [P in MyExclude<T, U>]: T[P]
}
```

## Extract\<T, U>

è”åˆç±»å‹å·¥å…·ï¼Œè”åˆç±»å‹ `T` å’Œ `U` çš„äº¤é›†ã€‚

### ä½¿ç”¨

```typescript
type T = Extract<'name' | 'age' | 'sex', 'age' | 'height'>

// ç›¸å½“äº
type T = 'age'
```

### å®ç°

```typescript
type MyExtract<T, U> = T extend U ? T : never
```

---

## NonNullable

æ’é™¤è”åˆç±»å‹ä¸­ä¸º `null` å’Œ `undefined` çš„ç±»å‹

### ä½¿ç”¨

```typescript
type T = NonNullable<string | number | undefined | null>

// ç­‰äº
type T = string | number
```

### å®ç°

```typescript
type MyNonNullable<T> = Exclude<T, null | undefined>
```

## Parameters

è·å–å‡½æ•°çš„å‚æ•°ç±»å‹ï¼Œå°†æ¯ä¸ªå‚æ•°ç±»å‹æ”¾åœ¨ä¸€ä¸ªå…ƒç»„ä¸­

### ä½¿ç”¨

```typescript
declare function f1(arg: { a: number; b: string })

type T0 = Parameters<() => string>
// T0 = []

type T1 = Parameters<(s: string) => void>
// T1 = [s: string]

type T2 = Parameters<<T>(arg: T) => T>
// T2 = [arg: unknown]

type T3 = Parameters<typeof f1>
// T3 = [arg: { a: number, b: string }]
```

### å®ç°

```typescript
type MyParameters<T extends (...arg: any) => any> = T extends (
  ...args: infer P
) => any
  ? P
  : never
```

## å‚è€ƒ

- [TypeScript å…¥é—¨æ•™ç¨‹ - å£°æ˜åˆå¹¶](https://ts.xcatliu.com/advanced/declaration-merging.html)
